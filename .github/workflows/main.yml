name: changelog
on: pull_request
env:
  GH_TOKEN: ${{ secrets.GH_TOKEN }}
  commitMsg: ${{ github.event.commits[0].message }}
jobs:
  changelog:
    strategy:
      matrix:
        types: [ "fix(", "perf(", "revert(", "docs(", "style(", "chore(", "refactor(","test(","build(","ci(",]
    runs-on: ubuntu-latest
    steps:
      - name: 🔍 GH_TOKEN
        if: env.GH_TOKEN == ''
        env: 
          GITHUB_TOKEN: ${{ secrets.GITHUB_TOKEN }}
        run: echo "GH_TOKEN=${GITHUB_TOKEN}" >> $GITHUB_ENV
      - name: checkout
        if: contains(env.commitMsg, matrix.types)
        uses: actions/checkout@v3
      - name: Use Node.js 18
        if: contains(env.commitMsg, matrix.types)
        uses: actions/setup-node@v3
        with:
          node-version: 18
          cache: "npm"
      - name: pull tags
        if: contains(env.commitMsg,  matrix.types)
        run: git pull --tags
      - name: set email
        if: contains(env.commitMsg,  matrix.types)
        run: git config --local user.email '10226084+Zwiqler94@users.noreply.github.com'
      - name: set username
        if: contains(env.commitMsg,  matrix.types)
        run: git config --local user.name 'Zwiqler94'
      - name: npm install
        if: contains(env.commitMsg,  matrix.types)
        run: npm ci
      - name: version
        if: contains(env.commitMsg,  matrix.types)
        run: npm version patch
      - name: push tags
        if: contains(env.commitMsg,  matrix.types)
        run: git push --tags
      - name: push code
        if: contains(env.commitMsg,  matrix.types)
        run: git push
