name: Version Test
'on':
  - push
env:
  GH_TOKEN: '${{ secrets.GH_TOKEN }}'
  commitMsg: '${{ github.event.commits[0].message }}'
jobs:
  VERSION:
    runs-on: ubuntu-latest
    steps:
      - name: check commit
        run: |
             if [[ $commitMsg =~ ^\A(fix\(.+\)|perf\(.+\)|revert\(.+\)|docs\(.+\)|style\(.+\)|chore\(.+\)|refactor\(.+\)|test\(.+\)|build\(.+\)|ci\(.+\)):(.|\s)+$ ]]; then
                echo "yup"
             fi
             exit 0
      - name: 🔍 GH_TOKEN
        if: env.GH_TOKEN == ''
        env: 
          GITHUB_TOKEN: ${{ secrets.GITHUB_TOKEN }}
        run: echo "GH_TOKEN=${GITHUB_TOKEN}" >> $GITHUB_ENV
      - name: checkout
        uses: actions/checkout@v3
      - name: Use Node.js 18
        uses: actions/setup-node@v3
        with:
          node-version: 18
          cache: "npm"
      - name: pull tags
        run: git pull --tags
      - name: set email
        run: git config --local user.email '10226084+Zwiqler94@users.noreply.github.com'
      - name: set username
        run: git config --local user.name 'Zwiqler94'
      - name: npm install
        run: npm ci
      - name: version
        run: npm version patch
      - name: push tags
        run: git push --tags
      - name: push code
        run: git push
