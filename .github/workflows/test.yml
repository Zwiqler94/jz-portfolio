name: Version Test
'on':
  - push
env:
  GH_TOKEN: '${{ secrets.GH_TOKEN }}'
  commitMsg: '${{ github.event.commits[0].message }}'
jobs:
  VERIFY_COMMIT:
    runs-on: ubuntu-latest
    outputs:
      version-type: ${{ steps.verifyCommit.ouputs.version-type }}
    steps:
      - name: check commit
        id: verifyCommit
        run: |
            if [[ $commitMsg =~ (BREAKING CHANGE|^(.|\s)+(\(.|\s\))?!:(.|\s)+$) ]]; then
                echo "version-type=major" >> "$GITHUB_OUTPUT"
                exit 0
            elif [[ $commitMsg =~ ^(fix(\(.+\))?|perf(\(.+\))?|revert(\(.+\))?|docs(\(.+\))?|style(\(.+\))?|chore(\(.+\))?|refactor(\(.+\))?|test(\(.+\))?|build(\(.+\))?|ci(\(.+\))?):(.|\s)+$ ]]; then
                echo "version-type=minor" >> "$GITHUB_OUTPUT"
                exit 0
            else
                exit 1
            fi
  VERSION:
    runs-on: ubuntu-latest
    needs: VERIFY_COMMIT
    steps:
      - env:
          val: ${{ needs.VERIFY_COMMIT.outputs.version-type }}
        run: echo "$val"
  

